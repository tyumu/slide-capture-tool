
##vscodeのAgentを使ってみたかったので使って作成したものです

# スライド動画から画像を自動抽出するプログラム

このプログラムは、ブラウザで動画を再生しながら、スライドの変化を自動的に検出し、新しいスライドのスクリーンショットを保存します。

## 機能

1. **Seleniumでブラウザ（Chrome）を起動**し、指定したURLの動画ページを開く
2. **ユーザーが動画の再生を開始**し、準備が完了したらEnterキーを押す
3. **プログラムは無限ループに入り**、一定間隔（例: 1秒ごと）で画面の状態をチェック
4. **OpenCVとscikit-imageを使用**し、前回チェックした時の画像と現在の画像を比較し、構造的類似度 (SSIM) を計算
5. **類似度が設定したしきい値（例: 90%）を下回った**ら、「スライドが変わった」と判断
6. **新しいスライドのスクリーンショット**を指定したフォルダに画像ファイルとして保存
7. **ユーザーがCtrl + C**でプログラムを終了するまで、これを繰り返す

## 必要なライブラリ

- OpenCV (cv2)
- Selenium
- scikit-image
- numpy
- webdriver-manager

## インストール

```bash
pip install -r requirements.txt
```

## 使用方法

1. `slide_capture.py`の設定項目を編集：
   - `VIDEO_URL`: 動画のURLを設定
   - `OUTPUT_DIR`: スクリーンショットの保存先フォルダ
   - `SIMILARITY_THRESHOLD`: 類似度のしきい値（0.0〜1.0）
   - `CHECK_INTERVAL_SECONDS`: チェック間隔（秒）
   - `CROP_BOX`: 比較範囲の指定（オプション）

2. プログラムを実行：
   ```bash
   python slide_capture.py
   ```

3. ブラウザが起動したら、動画を再生し、フルスクリーンなど最適な表示状態にする

4. コンソールでEnterキーを押して監視を開始

5. 終了するには Ctrl+C を押す

## 注意事項

- Google Chromeがインストールされている必要があります
- 初回実行時に、ChromeDriverが自動的にダウンロードされます
- 動画の再生バーや広告などを除外したい場合は、`CROP_BOX`を設定してください
